
R version 3.3.0 (2016-05-03) -- "Supposedly Educational"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #! /usr/bin/Rscript --vanilla
> 
> ## make.r
> ## 2016-06-03 david.montaner@gmail.com
> ## my make file for developing R packages
> 
> date ()
[1] "Fri Jun  3 17:08:45 2016"
> rm (list = ls ())
> R.version.string ##"R version 3.2.1 (2015-06-18)"
[1] "R version 3.3.0 (2016-05-03)"
> library (devtools); packageDescription ("devtools", fields = "Version") #"1.11.1"
[1] "1.11.1"
> #help (package = devtools)
> 
> ################################################################################
> 
> ## Clean up some directories. Usually not needed.
> unlink ("local", recursive = TRUE)
> unlink ("check", recursive = TRUE)
> ##unlink ("pkg/man", recursive = TRUE)  ## BE CAREFUL HERE !!!
> ##unlink ("pkg/NAMESPACE")              ## BE CAREFUL HERE !!!
> 
> ### Create directories
> dir.create ("local") ## to install the library locally
> dir.create ("check") ## to keep the output of the check command
> 
> ################################################################################
> 
> ### Build documentation and NAMESPACE
> document (pkg = "pkg")
Updating SNPediaR documentation
Loading SNPediaR
> 
> ### Test
> test (pkg = "pkg")
No tests: no files in /home/dmontaner/programas/r_mis_librerias/SNPediaR/pkg/tests/testthat match '^test.*\.[rR]$'
> 
> ################################################################################
> 
> ### First (quick) CHECK of the library
> ## see how to avoid testing here ???
> ## check (pkg = "pkg",
> ##        document = FALSE,      ## document: if ‘TRUE’ (the default), will update and check documentation before running formal check.
> ##        check_dir = "check",   ## check_dir: the directory in which the package is checked
> ##        vignettes = FALSE,                           ## do not run vignette code ............ when BUILDING
> ##        args = c ("--no-examples", "--no-vignettes") ## do not run vignette code and examples when CHECKING -> args: Additional arguments passed to ‘R CMD check’
> ##        )
> 
> ## Examples
> run_examples (pkg = "pkg") ## run examples separately from check
Updating SNPediaR documentation
Loading SNPediaR
Running 3 example files in SNPediaR --------------------------------------------
Loading SNPediaR
Running examples in extractTags.Rd ---------------------------------------------
> 
> res <- getPages (c ("Rs1234", "Rs53576"))
> t (sapply (res, extractSnpTags))
        rsid    Chromosome position    Orientation GMAF     Assembly
Rs1234  "1234"  "3"        "123615654" "plus"      NA       NA      
Rs53576 "53576" "3"        "8762685"   "plus"      "0.4128" "GRCh38"
        GenomeBuild dbSNPBuild geno1   geno2   geno3   StabilizedOrientation
Rs1234  NA          NA         "(A;A)" "(A;C)" "(C;C)" "plus"               
Rs53576 "38.1"      "141"      "(A;A)" "(A;G)" "(G;G)" "plus"               
        Status Merged Gene    Gene_s
Rs1234  NA     NA     "FAKE1" NA    
Rs53576 NA     NA     "OXTR"  "OXTR"
        Summary                                     
Rs1234  "a test snp 0.328905101289"                 
Rs53576 "influences social behavior and personality"
> 
> extractTags (res[[1]], tags = c("rsid", "Chromosome", "position"))
       rsid  Chromosome    position 
     "1234"         "3" "123615654" 
> 
> res <- getPages (c ("Rs1234(A;A)", "Rs1234(A;C)","Rs1234(C;C)"))
> t (sapply (res, extractGenotypeTags))
            rsid   allele1 allele2 repute magnitude
Rs1234(A;A) "1234" "A"     "A"     "Bad"  "2"      
Rs1234(A;C) "1234" "A"     "C"     "Good" "1.5"    
Rs1234(C;C) "1234" "C"     "C"     NA     "0"      
            summary                          
Rs1234(A;A) "summary of something bad"       
Rs1234(A;C) "heterozygote for something good"
Rs1234(C;C) "normal"                         
> 
> getPages (c ("Rs1234(A;A)", "Rs1234(A;C)","Rs1234(C;C)"),
+           wikiParseFunction = extractGenotypeTags)
$`Rs1234(A;A)`
                      rsid                    allele1 
                    "1234"                        "A" 
                   allele2                     repute 
                       "A"                      "Bad" 
                 magnitude                    summary 
                       "2" "summary of something bad" 

$`Rs1234(A;C)`
                             rsid                           allele1 
                           "1234"                               "A" 
                          allele2                            repute 
                              "C"                            "Good" 
                        magnitude                           summary 
                            "1.5" "heterozygote for something good" 

$`Rs1234(C;C)`
     rsid   allele1   allele2    repute magnitude   summary 
   "1234"       "C"       "C"        NA       "0"  "normal" 

> 
> getPages (c ("Rs1234(A;A)", "Rs1234(A;C)","Rs1234(C;C)"),
+           wikiParseFunction = extractGenotypeTags,
+           tags = c("rsid", "allele1", "allele2"))
$`Rs1234(A;A)`
   rsid allele1 allele2 
 "1234"     "A"     "A" 

$`Rs1234(A;C)`
   rsid allele1 allele2 
 "1234"     "A"     "C" 

$`Rs1234(C;C)`
   rsid allele1 allele2 
 "1234"     "C"     "C" 

> 
Running examples in getCategoryElements.Rd -------------------------------------
> 
> res <- getCategoryElements (category = "Is_a_medical_condition")
> head (res)
[1] "21-hydroxylase deficiency"          "3-Methylglutaconic aciduria type 2"
[3] "Abdominal aortic aneurysm"          "ABO blood group"                   
[5] "Acetylation"                        "Achondroplasia"                    
> 
> 
> # # DONTRUN
> # 
> # res <- getCategoryElements (category = "Is_a_snp")
> # 
> 
Running examples in getPages.Rd ------------------------------------------------
> 
> res <- getPages (titles = "Rs1234")
> res
$Rs1234
[1] "{{Rsnum\n|rsid=1234\n|Gene=FAKE1\n|Chromosome=3\n|position=123615654\n|Orientation=plus\n|StabilizedOrientation=plus\n|Summary=a test snp 0.328905101289\n|geno1=(A;A)\n|geno2=(A;C)\n|geno3=(C;C)\n}}\n{{ population diversity\n|geno1=(A;A)\n|geno2=(A;C)\n|geno3=(C;C)\n|CEU |0 |0 |0\n|HCB |0 |0 |0\n|JPT |0 |0 |0\n|YRI |0 |0 |0\n|ASW |0 |0 |0\n|CHB |0 |0 |0\n|CHD |0 |0 |0\n|GIH |0 |0 |0\n|LWK |0 |0 |0\n|MEX |0 |0 |0\n|MKK |0  |0 |0\n|TSI |0 |0 |0\n|HapMapRevision=27\n}}This page represents an arbitrary [[SNP]]. The main text body of a SNP page summarizes the associations between SNP variants and a range of human traits (body height, disease risk, response to drugs, even behavior). The science that supports these associations (peer-reviewed publications with citations) is indicated by links to [http://www.ncbi.nlm.nih.gov/pubmed/ PubMed] abstracts in the form of <nowiki>{{PMID|12345678}}</nowiki> or [PMID 12345678] style citations.\n\nTechnically, there was once a valid rs1234, but it has long since been merged into a different identifier, due to the natural changes of that system. \n\nFor this reason, on SNPedia, we will use this SNP to explain how to use many key SNPedia features.\n\nTo the upper right you will see a box with these fields:\n\n*is a [[snp]] . This tells you that you are looking at a page about a snp. You may sometimes see the words [[gene]] or [[genotype]].\n*is mentioned by . This will show you what other pages on SNPedia are related to this snp.\n*dbSNP  rs1234 . This will take you to the the graphs of population diversity on its [http://www.ncbi.nlm.nih.gov/projects/SNP/ ncbi dbsnp] page.\n*hapmap rs1234. overlay snpedia on the [http://snpedia.blogspot.com/2007/12/gbrowse-snpedia.html hapmap] genome\n*ensembl rs1234 . Takes you to the snp report at [http://www.ensembl.org/info/about/index.html ensembl]\n*google . Automatic google search\n*23andMe . Links to the 23andMe.com web site where registered users can find their own genotypes for this SNP.\n*23andMe all. Links to the 23andMe.com web site where registered users can find discussions about this SNP.\n\nThe colored box indicates the frequency of each genotype in 4 [[HapMap]] populations. CEU is European so the box indicates that 10% of Europeans are (A;A) colored brown, 60% are (A;C) colored green, and 30% are (C;C) colored blue. The Chinese (CHB) and Japanese (JPT) are mainly (C;C).  Click on the question mark for [[help (population diversity)|more information]]."

> 
> res <- getPages (titles = c ("Rs1234", "Rs1234(A;A)", "Rs1234(A;C)"))
> res
$Rs1234
[1] "{{Rsnum\n|rsid=1234\n|Gene=FAKE1\n|Chromosome=3\n|position=123615654\n|Orientation=plus\n|StabilizedOrientation=plus\n|Summary=a test snp 0.328905101289\n|geno1=(A;A)\n|geno2=(A;C)\n|geno3=(C;C)\n}}\n{{ population diversity\n|geno1=(A;A)\n|geno2=(A;C)\n|geno3=(C;C)\n|CEU |0 |0 |0\n|HCB |0 |0 |0\n|JPT |0 |0 |0\n|YRI |0 |0 |0\n|ASW |0 |0 |0\n|CHB |0 |0 |0\n|CHD |0 |0 |0\n|GIH |0 |0 |0\n|LWK |0 |0 |0\n|MEX |0 |0 |0\n|MKK |0  |0 |0\n|TSI |0 |0 |0\n|HapMapRevision=27\n}}This page represents an arbitrary [[SNP]]. The main text body of a SNP page summarizes the associations between SNP variants and a range of human traits (body height, disease risk, response to drugs, even behavior). The science that supports these associations (peer-reviewed publications with citations) is indicated by links to [http://www.ncbi.nlm.nih.gov/pubmed/ PubMed] abstracts in the form of <nowiki>{{PMID|12345678}}</nowiki> or [PMID 12345678] style citations.\n\nTechnically, there was once a valid rs1234, but it has long since been merged into a different identifier, due to the natural changes of that system. \n\nFor this reason, on SNPedia, we will use this SNP to explain how to use many key SNPedia features.\n\nTo the upper right you will see a box with these fields:\n\n*is a [[snp]] . This tells you that you are looking at a page about a snp. You may sometimes see the words [[gene]] or [[genotype]].\n*is mentioned by . This will show you what other pages on SNPedia are related to this snp.\n*dbSNP  rs1234 . This will take you to the the graphs of population diversity on its [http://www.ncbi.nlm.nih.gov/projects/SNP/ ncbi dbsnp] page.\n*hapmap rs1234. overlay snpedia on the [http://snpedia.blogspot.com/2007/12/gbrowse-snpedia.html hapmap] genome\n*ensembl rs1234 . Takes you to the snp report at [http://www.ensembl.org/info/about/index.html ensembl]\n*google . Automatic google search\n*23andMe . Links to the 23andMe.com web site where registered users can find their own genotypes for this SNP.\n*23andMe all. Links to the 23andMe.com web site where registered users can find discussions about this SNP.\n\nThe colored box indicates the frequency of each genotype in 4 [[HapMap]] populations. CEU is European so the box indicates that 10% of Europeans are (A;A) colored brown, 60% are (A;C) colored green, and 30% are (C;C) colored blue. The Chinese (CHB) and Japanese (JPT) are mainly (C;C).  Click on the question mark for [[help (population diversity)|more information]]."

$`Rs1234(A;A)`
[1] "{{Genotype\n|rsid=1234\n|allele1=A\n|allele2=A\n|magnitude=2\n|repute=Bad\n|summary=summary of something bad\n}}\npeople with this genotype experience ..."

$`Rs1234(A;C)`
[1] "{{Genotype\n|rsid=1234\n|allele1=A\n|allele2=C\n|magnitude=1.5\n|repute=Good\n|summary=heterozygote for something good\n}}\nYou are a carrier of one copy of the normal allele, and one copy of the interesting allele. As a result you ..."

> 
> myfun <- function (x) substring (x, 1, 5)
> lapply (res, myfun)
$Rs1234
[1] "{{Rsn"

$`Rs1234(A;A)`
[1] "{{Gen"

$`Rs1234(A;C)`
[1] "{{Gen"

> 
> res <- getPages (titles = c ("Rs1234", "Rs1234(A;A)", "Rs1234(A;C)"),
+ wikiParseFunction = myfun)
> res
$Rs1234
[1] "{{Rsn"

$`Rs1234(A;A)`
[1] "{{Gen"

$`Rs1234(A;C)`
[1] "{{Gen"

> 
Loading SNPediaR
> 
> ### Vignettes
> build_vignettes (pkg = "pkg")
Building SNPediaR vignettes
Moving SNPediaR.html, SNPediaR.R to inst/doc/
Copying SNPediaR.Rmd to inst/doc/
> 
> 
> ### FULL CHECK
> check (pkg = "pkg", check_dir = "check")
Updating SNPediaR documentation
Loading SNPediaR
Setting env vars ---------------------------------------------------------------
CFLAGS  : -Wall -pedantic
CXXFLAGS: -Wall -pedantic
Building SNPediaR --------------------------------------------------------------
'/usr/lib/R/bin/R' --no-site-file --no-environ --no-save --no-restore --quiet  \
  CMD build '/home/dmontaner/programas/r_mis_librerias/SNPediaR/pkg'  \
  --no-resave-data --no-manual 

* checking for file ‘/home/dmontaner/programas/r_mis_librerias/SNPediaR/pkg/DESCRIPTION’ ... OK
* preparing ‘SNPediaR’:
* checking DESCRIPTION meta-information ... OK
* installing the package to build vignettes
* creating vignettes ... OK
* checking for LF line-endings in source and make files
* checking for empty or unneeded directories
Removed empty directory ‘SNPediaR/tests/testthat’
* building ‘SNPediaR_0.0.3.tar.gz’

Setting env vars ---------------------------------------------------------------
_R_CHECK_CRAN_INCOMING_USE_ASPELL_: TRUE
_R_CHECK_CRAN_INCOMING_           : FALSE
_R_CHECK_FORCE_SUGGESTS_          : FALSE
Checking SNPediaR --------------------------------------------------------------
'/usr/lib/R/bin/R' --no-site-file --no-environ --no-save --no-restore --quiet  \
  CMD check '/tmp/Rtmp41jD0p/SNPediaR_0.0.3.tar.gz' --as-cran --timings  \
  --no-manual 

* using log directory ‘/home/dmontaner/programas/r_mis_librerias/SNPediaR/check/SNPediaR.Rcheck’
* using R version 3.3.0 (2016-05-03)
* using platform: x86_64-pc-linux-gnu (64-bit)
* using session charset: UTF-8
* using options ‘--no-manual --as-cran’
* checking for file ‘SNPediaR/DESCRIPTION’ ... OK
* this is package ‘SNPediaR’ version ‘0.0.3’
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for executable files ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking for sufficient/correct file permissions ... OK
* checking whether package ‘SNPediaR’ can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking ‘build’ directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the package can be unloaded cleanly ... OK
* checking whether the namespace can be loaded with stated dependencies ... OK
* checking whether the namespace can be unloaded cleanly ... OK
* checking loading without being on the library search path ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd line widths ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking installed files from ‘inst/doc’ ... OK
* checking files in ‘vignettes’ ... OK
* checking examples ... OK
* checking for unstated dependencies in ‘tests’ ... OK
* checking tests ...
  Running ‘testthat.R’
 OK
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in ‘inst/doc’ ... OK
* checking re-building of vignette outputs ... OK
* DONE

Status: OK

R CMD check results
0 errors | 0 warnings | 0 notes

> 
> ################################################################################
> 
> ### Local Installation
> install.packages ("pkg", lib = "local", repos = NULL, INSTALL_opts = "--html")
* installing *source* package ‘SNPediaR’ ...
** R
** inst
** preparing package for lazy loading
** help
*** installing help indices
  converting help for package ‘SNPediaR’
    finding HTML links ... done
    extractTags                             html  
    getCategoryElements                     html  
    getPages                                html  
** building package indices
** installing vignettes
** testing if installed package can be loaded
* DONE (SNPediaR)
> 
> ################################################################################
> 
> ## ##re-run local installation
> ## with_libpaths ("local", install ("pkg", lib = "local", args = "--html"))
> ## ## and this should work now
> ## help (package = pkg)
> ## browseVignettes ("pkg")
> ## vignette ("my_vignette", package = "pkg")
> 
> ################################################################################
> 
> ### Build the package
> build (pkg = "pkg", manual = TRUE, vignettes = TRUE)
'/usr/lib/R/bin/R' --no-site-file --no-environ --no-save --no-restore --quiet  \
  CMD build '/home/dmontaner/programas/r_mis_librerias/SNPediaR/pkg'  \
  --no-resave-data 

* checking for file ‘/home/dmontaner/programas/r_mis_librerias/SNPediaR/pkg/DESCRIPTION’ ... OK
* preparing ‘SNPediaR’:
* checking DESCRIPTION meta-information ... OK
* installing the package to build vignettes
* creating vignettes ... OK
* checking for LF line-endings in source and make files
* checking for empty or unneeded directories
Removed empty directory ‘SNPediaR/tests/testthat’
* building ‘SNPediaR_0.0.3.tar.gz’

[1] "/home/dmontaner/programas/r_mis_librerias/SNPediaR/SNPediaR_0.0.3.tar.gz"
> 
> 
> ###EXIT
> warnings ()
NULL
> sessionInfo ()
R version 3.3.0 (2016-05-03)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.4 LTS

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] SNPediaR_0.0.3  BiocStyle_1.8.0 devtools_1.11.1

loaded via a namespace (and not attached):
 [1] Rcpp_0.12.5     roxygen2_5.0.1  digest_0.6.9    crayon_1.3.1   
 [5] withr_1.0.1     bitops_1.0-6    R6_2.1.2        jsonlite_0.9.20
 [9] formatR_1.4     magrittr_1.5    evaluate_0.9    stringi_1.1.1  
[13] testthat_1.0.2  rmarkdown_0.9.6 tools_3.3.0     stringr_1.0.0  
[17] RCurl_1.95-4.8  yaml_2.1.13     htmltools_0.3.5 memoise_1.0.0  
[21] knitr_1.13     
> q ("no")
> proc.time()
   user  system elapsed 
 14.608   1.200  25.650 
